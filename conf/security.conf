# Security Configuration
security {
  # CORS Configuration
  cors {
    # Allowed origins for CORS requests
    allowedOrigins = [
      "http://localhost:3000",     # React development server
    ]

    # Allow credentials (cookies, authorization headers)
    allowCredentials = true

    # Allowed HTTP methods
    allowedMethods = ["GET", "POST", "PUT", "PATCH", "DELETE", "HEAD", "OPTIONS"]

    # Allowed headers
    allowedHeaders = [
      "Accept",
      "Accept-Language",
      "Content-Language",
      "Content-Type",
      "Authorization",
      "X-Requested-With",
      "X-CSRF-Token"
    ]

    # Exposed headers (headers that the frontend can access)
    exposedHeaders = [
      "X-Total-Count",
      "X-Page-Count",
      "Content-Range"
    ]

    # Preflight request cache duration (in seconds)
    maxAge = 3600
  }

  # Rate Limiting Configuration
  rateLimit {
    # Enable rate limiting
    enabled = true

    # General API rate limit (requests per minute)
    general {
      requests = 100
      duration = "1 minute"
    }

    # Login endpoint specific rate limit
    login {
      requests = 5
      duration = "1 minute"
    }

    # Registration endpoint rate limit
    registration {
      requests = 3
      duration = "5 minutes"
    }
  }

  # Security Headers Configuration
  headers {
    # Content Security Policy
    contentSecurityPolicy = "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

    # X-Frame-Options
    frameOptions = "DENY"

    # X-Content-Type-Options
    contentTypeOptions = "nosniff"

    # Referrer Policy
    referrerPolicy = "strict-origin-when-cross-origin"

    # Permissions Policy
    permissionsPolicy = "camera=(), microphone=(), geolocation=()"
  }
}
# API Access Control
api {
  # Public endpoints (no authentication required)
  publicEndpoints = [
    "/api/auth/login",
    "/api/auth/logout",
    "/api/auth/register",
  ]

  # Admin only endpoints
  adminEndpoints = [
    "/api/admin/*",
    "/api/users/admin",
  ]

  # User endpoints (require authentication)
  userEndpoints = [
    "/api/users/*",
    "/api/test/protected",
  ]
}
