# Security Configuration
security {
  # CORS Configuration
  cors {
    frontendUrl = "http://localhost:3000"
    frontendUrl = ${?FRONTEND_URL}
    # Allowed origins for CORS requests
    allowedOrigins = [
      ${security.cors.frontendUrl}
    ]

    # Allow credentials (cookies, authorization headers)
    allowCredentials = true

    # Allowed HTTP methods
    allowedMethods = ["GET", "POST", "PUT", "PATCH", "DELETE", "HEAD", "OPTIONS"]

    # Allowed headers
    allowedHeaders = [
      "Accept",
      "Accept-Language",
      "Content-Language",
      "Content-Type",
      "Authorization",
      "X-Requested-With",
      "X-CSRF-Token"
    ]

    # Exposed headers (headers that the frontend can access)
    exposedHeaders = [
      "X-Total-Count",
      "X-Page-Count",
      "Content-Range"
    ]

    # Preflight request cache duration (in seconds)
    maxAge = 3600
  }

  # Security Headers Configuration
  headers {
    # Content Security Policy
    contentSecurityPolicy = "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

    # X-Frame-Options
    frameOptions = "DENY"

    # X-Content-Type-Options
    contentTypeOptions = "nosniff"

    # Referrer Policy
    referrerPolicy = "strict-origin-when-cross-origin"

    # Permissions Policy
    permissionsPolicy = "camera=(), microphone=(), geolocation=()"
  }
}
# API Access Control
api {
  # Public endpoints (no authentication required)
  publicEndpoints = [
    "/api/auth/login",
    "/api/auth/logout",
    "/api/auth/register",
    "/api/url-preview",
    "/api/url-preview"
  ]

  # Admin only endpoints
  adminEndpoints = [
    "/api/admin/*",
    "/api/users/admin",
  ]

  # User endpoints (require authentication)
  userEndpoints = [
    "/api/auth/me",
    "/api/auth/role",
    "/api/auth/check"
  ]
}
